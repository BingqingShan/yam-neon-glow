<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YAM ‚Äî Pitch Deck (Neon Glow)</title>
    <link href="https://fonts.googleapis.com/css2?family=Bagel+Fat+One&family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        /* ===========================================
           THEME: NEON GLOW
           Deep purple-black with Liquid Ether WebGL
           background, gradient text with neon feel
           =========================================== */
        :root {
            --bg-primary: #0c0618;
            --bg-card: rgba(255,255,255,0.03);
            --bg-card-border: rgba(255,255,255,0.06);
            --accent-primary: #e88fc5;
            --accent-secondary: #b8a0e8;
            --accent-tertiary: #88d4e8;
            --text-primary: #f0eef5;
            --text-muted: rgba(240,238,245,0.4);

            --font-display: 'Bagel Fat One', cursive;
            --font-body: 'Nunito', sans-serif;
            --title-size: clamp(2.5rem, 7vw, 5.5rem);
            --h2-size: clamp(1.5rem, 3.5vw, 2.8rem);
            --body-size: clamp(0.75rem, 1.3vw, 1.05rem);
            --small-size: clamp(0.65rem, 1vw, 0.85rem);
            --label-size: clamp(0.6rem, 0.85vw, 0.75rem);

            --slide-padding: clamp(1.5rem, 4vw, 4rem);
            --content-gap: clamp(0.5rem, 1.5vw, 1.5rem);
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
            --duration: 0.7s;
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        html {
            scroll-behavior: smooth;
            scroll-snap-type: y mandatory;
            height: 100%; overflow-x: hidden;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100%; overflow-x: hidden;
        }

        /* ===========================================
           LIQUID ETHER BACKGROUND
           =========================================== */
        #liquid-ether-bg {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            touch-action: none;
        }
        #liquid-ether-bg canvas {
            width: 100% !important;
            height: 100% !important;
            display: block;
        }

        /* ===========================================
           SLIDE CONTAINER
           =========================================== */
        .slide {
            width: 100vw; height: 100vh; height: 100dvh;
            scroll-snap-align: start; position: relative;
            overflow: hidden; display: flex; flex-direction: column;
            justify-content: center; padding: var(--slide-padding);
            background: transparent;
        }

        .slide-inner {
            position: relative; z-index: 2;
            display: flex; flex-direction: column;
            gap: var(--content-gap); max-height: 100%;
        }

        /* ===========================================
           TYPOGRAPHY
           =========================================== */
        .display-text {
            font-family: var(--font-display);
            font-size: var(--title-size);
            font-weight: 400; line-height: 1.1;
        }
        .slide-title {
            font-family: var(--font-display);
            font-size: var(--h2-size);
            font-weight: 400; line-height: 1.2;
        }
        .section-label {
            font-size: var(--label-size); font-weight: 700;
            letter-spacing: 0.25em; text-transform: uppercase;
            color: var(--text-muted);
        }
        .body-text { font-size: var(--body-size); font-weight: 500; line-height: 1.6; }
        .small-text { font-size: var(--small-size); line-height: 1.5; }

        .gradient-text {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 50%, var(--accent-tertiary) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }

        .glow-text {
            filter: drop-shadow(0 0 25px rgba(184,160,232,0.35));
        }

        /* ===========================================
           CARDS & GRIDS
           =========================================== */
        .card-grid { display: grid; gap: clamp(0.5rem, 1.2vw, 1rem); }
        .card-grid.cols-2 { grid-template-columns: repeat(2, 1fr); }
        .card-grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
        .card-grid.cols-4 { grid-template-columns: repeat(4, 1fr); }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--bg-card-border);
            border-radius: 16px;
            padding: clamp(0.8rem, 1.5vw, 1.5rem);
            display: flex; flex-direction: column;
            gap: clamp(0.25rem, 0.6vw, 0.5rem);
            backdrop-filter: blur(10px);
            transition: border-color 0.3s ease;
        }
        .card:hover { border-color: rgba(184,160,232,0.15); }

        .card-glow {
            background: linear-gradient(135deg, rgba(232,143,197,0.08), rgba(136,212,232,0.08));
            border: 1px solid rgba(184,160,232,0.2);
        }

        .card-icon { font-size: clamp(1.2rem, 2vw, 1.8rem); }
        .card-title { font-size: clamp(0.8rem, 1.2vw, 1rem); font-weight: 700; }
        .card-desc { font-size: var(--small-size); line-height: 1.5; color: var(--text-muted); }

        /* ===========================================
           STATS
           =========================================== */
        .stat-number { font-family: var(--font-display); font-size: clamp(2rem, 5vw, 4rem); line-height: 1; }
        .stat-label { font-size: var(--small-size); font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; }

        /* ===========================================
           TIMELINE
           =========================================== */
        .timeline { display: flex; gap: clamp(0.4rem, 1vw, 1rem); }
        .timeline-step {
            flex: 1; display: flex; flex-direction: column;
            gap: clamp(0.25rem, 0.5vw, 0.4rem);
            padding-top: clamp(0.6rem, 1vw, 0.8rem);
            position: relative;
        }
        .timeline-step::before {
            content: ''; position: absolute;
            top: 0; left: 0; right: 0; height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-tertiary));
            border-radius: 1px;
            box-shadow: 0 0 8px rgba(184,160,232,0.3);
        }
        .step-num { font-family: var(--font-display); font-size: clamp(1rem, 1.8vw, 1.5rem); }
        .step-title { font-size: clamp(0.75rem, 1.1vw, 0.95rem); font-weight: 700; }
        .step-desc { font-size: var(--small-size); color: var(--text-muted); line-height: 1.4; }

        /* ===========================================
           TWO-COL & BULLETS
           =========================================== */
        .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: clamp(1rem, 2vw, 2rem); align-items: start; }
        .bullet-list { list-style: none; display: flex; flex-direction: column; gap: clamp(0.3rem, 0.7vw, 0.6rem); }
        .bullet-list li { font-size: var(--body-size); line-height: 1.5; padding-left: 1.2em; position: relative; }
        .bullet-list li::before {
            content: ''; position: absolute; left: 0; top: 0.55em;
            width: 6px; height: 6px; border-radius: 50%;
            background: var(--accent-secondary);
            box-shadow: 0 0 6px var(--accent-secondary);
        }

        /* ===========================================
           TEAM
           =========================================== */
        .team-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: clamp(0.8rem, 1.5vw, 1.5rem); }
        .team-name { font-family: var(--font-display); font-size: clamp(1rem, 1.8vw, 1.5rem); }
        .team-role { font-size: var(--small-size); font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); }
        .team-creds { font-size: var(--small-size); color: var(--text-muted); line-height: 1.4; }

        /* ===========================================
           DIVIDER LINE
           =========================================== */
        .glow-divider {
            width: clamp(40px, 6vw, 80px); height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-tertiary));
            border-radius: 1px;
            box-shadow: 0 0 10px rgba(184,160,232,0.4);
        }

        /* ===========================================
           CORNER ELEMENTS
           =========================================== */
        .brand-mark {
            position: absolute; top: var(--slide-padding); left: var(--slide-padding);
            font-family: var(--font-display); font-size: clamp(0.7rem, 1vw, 0.9rem);
            z-index: 10;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .slide-number {
            position: absolute; bottom: var(--slide-padding); right: var(--slide-padding);
            font-size: var(--label-size); letter-spacing: 0.15em; color: var(--text-muted); z-index: 10;
        }

        /* ===========================================
           ANIMATIONS
           =========================================== */
        .reveal {
            opacity: 0; transform: translateY(20px);
            transition: opacity var(--duration) var(--ease-out-expo), transform var(--duration) var(--ease-out-expo);
        }
        .slide.visible .reveal { opacity: 1; transform: translateY(0); }
        .reveal-delay-1 { transition-delay: 0.1s; }
        .reveal-delay-2 { transition-delay: 0.2s; }
        .reveal-delay-3 { transition-delay: 0.3s; }
        .reveal-delay-4 { transition-delay: 0.4s; }

        /* ===========================================
           PROGRESS & NAV
           =========================================== */
        .progress-bar {
            position: fixed; top: 0; left: 0; height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-tertiary));
            box-shadow: 0 0 8px rgba(184,160,232,0.4);
            z-index: 100; transition: width 0.3s ease; width: 0%;
        }
        .nav-dots {
            position: fixed; right: clamp(0.8rem, 1.5vw, 1.5rem);
            top: 50%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 8px; z-index: 100;
        }
        .nav-dot {
            width: 7px; height: 7px; border-radius: 50%;
            background: rgba(255,255,255,0.12); border: none;
            cursor: pointer; transition: all 0.3s; padding: 0;
        }
        .nav-dot.active {
            background: var(--accent-secondary);
            box-shadow: 0 0 8px var(--accent-secondary);
            transform: scale(1.4);
        }

        /* ===========================================
           RESPONSIVE
           =========================================== */
        @media (max-height: 700px) {
            :root { --slide-padding: clamp(1rem,3vw,2.5rem); --content-gap: clamp(0.4rem,1vw,1rem); --title-size: clamp(2rem,6vw,4rem); --h2-size: clamp(1.2rem,3vw,2.2rem); }
        }
        @media (max-height: 600px) {
            :root { --slide-padding: clamp(0.75rem,2.5vw,1.5rem); --title-size: clamp(1.5rem,5vw,3rem); --body-size: clamp(0.7rem,1.1vw,0.9rem); }
            .nav-dots { display: none; }
        }
        @media (max-height: 500px) {
            :root { --slide-padding: clamp(0.5rem,2vw,1rem); --title-size: clamp(1.2rem,4vw,2rem); --h2-size: clamp(1rem,2.5vw,1.5rem); }
        }
        @media (max-width: 768px) {
            .card-grid.cols-3, .card-grid.cols-4 { grid-template-columns: repeat(2, 1fr); }
            .two-col, .team-grid { grid-template-columns: 1fr; }
            .timeline { flex-direction: column; }
        }
        @media (max-width: 480px) { .card-grid.cols-2 { grid-template-columns: 1fr; } }
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.2s !important; }
            html { scroll-behavior: auto; }
            #liquid-ether-bg { display: none; }
        }
    </style>
</head>
<body>

<!-- LIQUID ETHER WEBGL BACKGROUND -->
<div id="liquid-ether-bg"></div>

<div class="progress-bar" id="progressBar"></div>
<nav class="nav-dots" id="navDots"></nav>

<!-- SLIDE 1: TITLE -->
<section class="slide" id="slide-1">
    <div class="slide-inner" style="align-items:center;text-align:center;justify-content:center;height:100%;">
        <div class="display-text reveal glow-text gradient-text">yam</div>
        <div class="glow-divider reveal reveal-delay-1" style="margin:0 auto;"></div>
        <p class="body-text reveal reveal-delay-2" style="max-width:550px;">
            The <span class="gradient-text" style="font-weight:700;">AI-native Roblox</span> for creators and brands to engage audiences and unlock revenue
        </p>
        <p class="small-text reveal reveal-delay-3" style="color:var(--text-muted);">YC S25 &middot; San Francisco & New York</p>
    </div>
    <div class="brand-mark">yam</div>
    <div class="slide-number">01 / 12</div>
</section>

<!-- SLIDE 2: PROBLEM -->
<section class="slide" id="slide-2">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">THE PROBLEM</div>
        <h2 class="slide-title reveal reveal-delay-1">Creators are <span class="gradient-text glow-text">burning out</span></h2>
        <div class="card-grid cols-3 reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div class="card">
                <div class="card-icon">üîÅ</div>
                <div class="card-title" style="color:var(--text-primary);">Content Treadmill</div>
                <div class="card-desc">All energy on reach ‚Äî none left for engaging the audience they already have</div>
            </div>
            <div class="card">
                <div class="card-icon">üìâ</div>
                <div class="card-title" style="color:var(--text-primary);">Engagement Dying</div>
                <div class="card-desc">15‚Äì25% monthly churn in Discord communities. #1 reason: "nothing to do." Losing $300‚Äì$5K/mo</div>
            </div>
            <div class="card">
                <div class="card-icon">üö´</div>
                <div class="card-title" style="color:var(--text-primary);">Platforms Retreating</div>
                <div class="card-desc">TikTok killed Effect House. Meta shut Spark AR. Creators left without tools</div>
            </div>
        </div>
        <p class="body-text reveal reveal-delay-3" style="color:var(--text-muted);margin-top:auto;">Platforms are built for reach, not engagement. Engagement drives revenue ‚Äî and it's broken.</p>
    </div>
    <div class="slide-number">02 / 12</div>
</section>

<!-- SLIDE 3: SOLUTION -->
<section class="slide" id="slide-3">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">THE SOLUTION</div>
        <h2 class="slide-title reveal reveal-delay-1">Think <span class="gradient-text glow-text">Midjourney</span> for miniApps</h2>
        <p class="body-text reveal reveal-delay-2" style="max-width:650px;margin-top:var(--content-gap);">
            AI agents inside Discord & Telegram that understand community context and proactively help creators build interactive miniApps ‚Äî quizzes, polls, games, and more.
        </p>
        <div class="card-grid cols-2 reveal reveal-delay-3" style="margin-top:var(--content-gap);max-width:700px;">
            <div class="card-glow card">
                <div class="card-title gradient-text">Agentic Creation</div>
                <div class="card-desc" style="color:var(--text-primary);opacity:0.8;">Describe in natural language ‚Üí AI generates fully interactive apps in real time</div>
            </div>
            <div class="card-glow card">
                <div class="card-title gradient-text">Instant Deploy</div>
                <div class="card-desc" style="color:var(--text-primary);opacity:0.8;">Deploys directly into the community ‚Äî no links, no friction</div>
            </div>
        </div>
    </div>
    <div class="slide-number">03 / 12</div>
</section>

<!-- SLIDE 4: HOW IT WORKS -->
<section class="slide" id="slide-4">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">HOW IT WORKS</div>
        <h2 class="slide-title reveal reveal-delay-1">Conversation to <span class="gradient-text glow-text">live experience</span></h2>
        <div class="timeline reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div class="timeline-step">
                <div class="step-num gradient-text">01</div>
                <div class="step-title" style="color:var(--text-primary);">Learn Context</div>
                <div class="step-desc">Bot auto-learns community topics, interests, and engagement patterns</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">02</div>
                <div class="step-title" style="color:var(--text-primary);">Suggest Experiences</div>
                <div class="step-desc">Recommends quizzes, games, and content based on community signals</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">03</div>
                <div class="step-title" style="color:var(--text-primary);">Build via Chat</div>
                <div class="step-desc">Creator describes what they want ‚Äî AI generates the full interactive app</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">04</div>
                <div class="step-title" style="color:var(--text-primary);">Deploy Instantly</div>
                <div class="step-desc">One click to launch as a mini webapp in Discord or Telegram</div>
            </div>
        </div>
    </div>
    <div class="slide-number">04 / 12</div>
</section>

<!-- SLIDE 5: WHY NOW -->
<section class="slide" id="slide-5">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">WHY NOW</div>
        <h2 class="slide-title reveal reveal-delay-1">Three forces <span class="gradient-text glow-text">converging</span></h2>
        <div class="card-grid cols-3 reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div class="card">
                <div class="card-icon">ü§ñ</div>
                <div class="card-title" style="color:var(--text-primary);">AI Creation Revolution</div>
                <div class="card-desc">Anyone can build interactive experiences with natural language for the first time</div>
            </div>
            <div class="card">
                <div class="card-icon">üîì</div>
                <div class="card-title" style="color:var(--text-primary);">Platform Power Vacuum</div>
                <div class="card-desc">TikTok killed Effect House. Meta shut Spark AR. Creators need new tools</div>
            </div>
            <div class="card">
                <div class="card-icon">üí¨</div>
                <div class="card-title" style="color:var(--text-primary);">1.3B Community Users</div>
                <div class="card-desc">Discord + Telegram have massive audiences, full bot access, zero interactive infra</div>
            </div>
        </div>
    </div>
    <div class="slide-number">05 / 12</div>
</section>

<!-- SLIDE 6: MARKET OPPORTUNITY -->
<section class="slide" id="slide-6">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">MARKET OPPORTUNITY</div>
        <h2 class="slide-title reveal reveal-delay-1">A <span class="gradient-text glow-text">$5B+</span> opportunity</h2>
        <div class="two-col reveal reveal-delay-2" style="margin-top:var(--content-gap);flex:1;">
            <div style="display:flex;flex-direction:column;gap:clamp(0.8rem,1.5vh,1.5rem);">
                <div><div class="stat-number gradient-text glow-text">1.3B</div><div class="stat-label">Combined MAU ‚Äî Discord + Telegram</div></div>
                <div><div class="stat-number gradient-text glow-text">200‚Äì400K</div><div class="stat-label">Monetizing Discord servers</div></div>
                <div><div class="stat-number gradient-text glow-text">3.9B</div><div class="stat-label">TikTok + Instagram users (expansion)</div></div>
            </div>
            <div class="card" style="height:fit-content;">
                <div class="card-title gradient-text">The Roblox Precedent</div>
                <div class="card-desc" style="font-size:var(--body-size);color:var(--text-primary);opacity:0.8;">Roblox generates $3.5B from 80M gamers. Discord & Telegram have 1.3B users ‚Äî and zero infrastructure for interactive monetization.</div>
                <div class="small-text" style="color:var(--text-muted);margin-top:clamp(0.3rem,0.6vh,0.5rem);">
                    <strong style="color:var(--accent-tertiary);">Beachhead:</strong> Discord server monetizers<br>
                    <strong style="color:var(--accent-tertiary);">Expand to:</strong> TikTok, Instagram, D2C brands
                </div>
            </div>
        </div>
    </div>
    <div class="slide-number">06 / 12</div>
</section>

<!-- SLIDE 7: TRACTION -->
<section class="slide" id="slide-7">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">TRACTION</div>
        <h2 class="slide-title reveal reveal-delay-1">From insight to <span class="gradient-text glow-text">pilot</span></h2>
        <div class="timeline reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div class="timeline-step">
                <div class="step-num gradient-text">15</div>
                <div class="step-title" style="color:var(--text-primary);">Creator Interviews</div>
                <div class="step-desc">Identified pain: balancing content creation vs. engaging audiences for conversion</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">MVP</div>
                <div class="step-title" style="color:var(--text-primary);">Built & Shipping</div>
                <div class="step-desc">Auto-learns context, suggests experiences, builds via chat, deploys instantly</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">4</div>
                <div class="step-title" style="color:var(--text-primary);">Beta Creators</div>
                <div class="step-desc">Private pilot launch with creators and their communities</div>
            </div>
            <div class="timeline-step">
                <div class="step-num gradient-text">300K+</div>
                <div class="step-title" style="color:var(--text-primary);">Community Members</div>
                <div class="step-desc">Beta reach across pilot creator communities</div>
            </div>
        </div>
    </div>
    <div class="slide-number">07 / 12</div>
</section>

<!-- SLIDE 8: BUSINESS MODEL -->
<section class="slide" id="slide-8">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">BUSINESS MODEL</div>
        <h2 class="slide-title reveal reveal-delay-1">Four phases to <span class="gradient-text glow-text">full economy</span></h2>
        <div class="card-grid cols-4 reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div class="card" style="border-top:2px solid var(--accent-primary);box-shadow:0 -4px 15px rgba(232,143,197,0.1);">
                <div class="small-text" style="color:var(--accent-primary);font-weight:700;">PHASE 1</div>
                <div class="card-title" style="color:var(--text-primary);">Creation Engine</div>
                <div class="card-desc">Subscription + AI tokens. Creator pays to build.</div>
            </div>
            <div class="card" style="border-top:2px solid var(--accent-secondary);box-shadow:0 -4px 15px rgba(184,160,232,0.1);">
                <div class="small-text" style="color:var(--accent-secondary);font-weight:700;">PHASE 2</div>
                <div class="card-title" style="color:var(--text-primary);">In-App Purchases</div>
                <div class="card-desc">10% platform fee on transactions ‚Äî paid experiences, digital goods, tips.</div>
            </div>
            <div class="card" style="border-top:2px solid var(--accent-tertiary);box-shadow:0 -4px 15px rgba(136,212,232,0.1);">
                <div class="small-text" style="color:var(--accent-tertiary);font-weight:700;">PHASE 3</div>
                <div class="card-title" style="color:var(--text-primary);">Marketplace</div>
                <div class="card-desc">15% fee. Clone, remix, resell. Experiences become products.</div>
            </div>
            <div class="card" style="border-top:2px solid var(--text-primary);box-shadow:0 -4px 15px rgba(240,238,245,0.05);">
                <div class="small-text" style="font-weight:700;">PHASE 4</div>
                <div class="card-title" style="color:var(--text-primary);">Full Economy</div>
                <div class="card-desc">Brand partnerships for targeted ads within the YAM ecosystem.</div>
            </div>
        </div>
    </div>
    <div class="slide-number">08 / 12</div>
</section>

<!-- SLIDE 9: COMPETITION -->
<section class="slide" id="slide-9">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">COMPETITION</div>
        <h2 class="slide-title reveal reveal-delay-1">Why <span class="gradient-text glow-text">YAM</span> wins</h2>
        <div class="card-grid cols-2 reveal reveal-delay-2" style="margin-top:var(--content-gap);max-width:800px;">
            <div class="card">
                <div class="card-title" style="color:var(--text-muted);">Vibe Coding (Lovable, Bolt)</div>
                <div class="card-desc">Build apps, but no distribution. Creators get a website, not an engaged audience.</div>
            </div>
            <div class="card">
                <div class="card-title" style="color:var(--text-muted);">Discord Bots (MEE6)</div>
                <div class="card-desc">Moderation only. No monetization, no interactive experiences.</div>
            </div>
            <div class="card">
                <div class="card-title" style="color:var(--text-muted);">Creator Platforms (Stan, Beacons)</div>
                <div class="card-desc">Sell static products. No engagement loop, no community integration.</div>
            </div>
            <div class="card-glow card">
                <div class="card-title gradient-text">YAM</div>
                <div class="card-desc" style="color:var(--text-primary);opacity:0.9;">Full-stack Roblox model: Tools + Distribution + Monetization. Deployed where the audience lives.</div>
            </div>
        </div>
    </div>
    <div class="slide-number">09 / 12</div>
</section>

<!-- SLIDE 10: DATA FLYWHEEL -->
<section class="slide" id="slide-10">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">THE MOAT</div>
        <h2 class="slide-title reveal reveal-delay-1"><span class="gradient-text glow-text">Data flywheel</span> others can't build</h2>
        <div class="two-col reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div>
                <ul class="bullet-list">
                    <li>We live <strong>inside</strong> the community ‚Äî not outside it</li>
                    <li>Every interaction captures engagement signals, preferences, behavior</li>
                    <li>AI learns what the community wants and helps creators deliver</li>
                    <li>Better experiences ‚Üí more engagement ‚Üí more data ‚Üí better suggestions</li>
                </ul>
            </div>
            <div style="display:flex;flex-direction:column;gap:clamp(0.5rem,1vh,0.8rem);">
                <div class="card" style="background:rgba(232,143,197,0.06);border-color:rgba(232,143,197,0.15);box-shadow:0 0 15px rgba(232,143,197,0.05);">
                    <div class="stat-number" style="color:var(--accent-primary);font-size:clamp(1.5rem,3vw,2.5rem);">20‚Äì40%</div>
                    <div class="stat-label">Telegram Mini App CTRs</div>
                </div>
                <div class="card" style="background:rgba(136,212,232,0.06);border-color:rgba(136,212,232,0.15);box-shadow:0 0 15px rgba(136,212,232,0.05);">
                    <div class="stat-number" style="color:var(--accent-tertiary);font-size:clamp(1.5rem,3vw,2.5rem);">28%</div>
                    <div class="stat-label">Telegram engagement (10√ó Instagram)</div>
                </div>
                <div class="card" style="background:rgba(184,160,232,0.06);border-color:rgba(184,160,232,0.15);box-shadow:0 0 15px rgba(184,160,232,0.05);">
                    <div class="stat-number" style="color:var(--accent-secondary);font-size:clamp(1.5rem,3vw,2.5rem);">2√ó</div>
                    <div class="stat-label">More conversions from interactive content</div>
                </div>
            </div>
        </div>
    </div>
    <div class="slide-number">10 / 12</div>
</section>

<!-- SLIDE 11: TEAM -->
<section class="slide" id="slide-11">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="justify-content:center;height:100%;">
        <div class="section-label reveal">THE TEAM</div>
        <h2 class="slide-title reveal reveal-delay-1">Built by people who <span class="gradient-text glow-text">lived it</span></h2>
        <div class="team-grid reveal reveal-delay-2" style="margin-top:var(--content-gap);">
            <div>
                <div class="team-name gradient-text">Qinyu</div>
                <div class="team-role">Creator Tools Expert</div>
                <div class="team-creds">TikTok Effect House ‚Äî AI tools for 800K+ AR creators, 5√ó publishing rates. Built Discord's 6th largest server (800K members). Swift Media ‚Äî GenAI modding tools, 2,300+ creators in 5 months. 2 patents in mixed reality.</div>
            </div>
            <div>
                <div class="team-name gradient-text">Shan</div>
                <div class="team-role">Product & Growth</div>
                <div class="team-creds">Instagram & Messenger ‚Äî shipped for billions of users. Founded KabCash ‚Äî 0‚Üí100K users, $2M ARR year one. ConsenSys/MetaMask ‚Äî community adoption, 100M users. Previous YC acceptance (2022).</div>
            </div>
            <div>
                <div class="team-name gradient-text">Crystal</div>
                <div class="team-role">Design & Experience</div>
                <div class="team-creds">Cisco AI Agent Studio ‚Äî designed agent creation from scratch. 2 years growth design at Webex for millions. Founding designer at Amesite ‚Äî gamified learning, zero to IPO.</div>
            </div>
        </div>
    </div>
    <div class="slide-number">11 / 12</div>
</section>

<!-- SLIDE 12: CLOSING -->
<section class="slide" id="slide-12">
    <div class="brand-mark">yam</div>
    <div class="slide-inner" style="align-items:center;text-align:center;justify-content:center;height:100%;">
        <div class="display-text reveal glow-text gradient-text">yam</div>
        <div class="glow-divider reveal reveal-delay-1" style="margin:0 auto;"></div>
        <p class="body-text reveal reveal-delay-2" style="max-width:550px;">
            Creators don't lack tools ‚Äî they lack an <span class="gradient-text" style="font-weight:700;">ecosystem</span>. We're building the Roblox for community-driven interactive experiences.
        </p>
        <div class="reveal reveal-delay-3" style="display:flex;gap:clamp(1rem,3vw,3rem);margin-top:clamp(0.5rem,1.5vh,1.5rem);">
            <div style="text-align:center;"><div class="stat-number gradient-text glow-text" style="font-size:clamp(1.5rem,3vw,2.5rem);">$5B+</div><div class="stat-label">Market</div></div>
            <div style="text-align:center;"><div class="stat-number gradient-text glow-text" style="font-size:clamp(1.5rem,3vw,2.5rem);">1.3B</div><div class="stat-label">Users</div></div>
            <div style="text-align:center;"><div class="stat-number gradient-text glow-text" style="font-size:clamp(1.5rem,3vw,2.5rem);">300K+</div><div class="stat-label">Beta Reach</div></div>
        </div>
        <p class="small-text reveal reveal-delay-4" style="color:var(--text-muted);">bqshan@umich.edu &middot; San Francisco & New York</p>
    </div>
    <div class="slide-number">12 / 12</div>
</section>

<script>
/* ===========================================
   SLIDE PRESENTATION CONTROLLER
   =========================================== */
class SlidePresentation {
    constructor() {
        this.slides = document.querySelectorAll('.slide');
        this.currentSlide = 0;
        this.isTransitioning = false;
        this.touchStartY = 0;
        this.init();
    }
    init() {
        this.createNavDots();
        this.slides[0].classList.add('visible');
        this.updateNavDots();
        this.updateProgress();
        document.addEventListener('keydown', (e) => this.handleKeydown(e));
        document.addEventListener('wheel', (e) => this.handleWheel(e), { passive: false });
        document.addEventListener('touchstart', (e) => { this.touchStartY = e.touches[0].clientY; }, { passive: true });
        document.addEventListener('touchend', (e) => { const d = this.touchStartY - e.changedTouches[0].clientY; if (Math.abs(d) > 50) d > 0 ? this.next() : this.prev(); }, { passive: true });
        const obs = new IntersectionObserver((entries) => { entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); }); }, { threshold: 0.3 });
        this.slides.forEach(s => obs.observe(s));
    }
    createNavDots() {
        const nav = document.getElementById('navDots');
        this.slides.forEach((_, i) => { const d = document.createElement('button'); d.className = 'nav-dot'; d.setAttribute('aria-label', `Slide ${i+1}`); d.addEventListener('click', () => this.goTo(i)); nav.appendChild(d); });
    }
    handleKeydown(e) {
        if (['ArrowDown','ArrowRight',' '].includes(e.key)) { e.preventDefault(); this.next(); }
        else if (['ArrowUp','ArrowLeft'].includes(e.key)) { e.preventDefault(); this.prev(); }
    }
    handleWheel(e) { e.preventDefault(); if (this.isTransitioning) return; if (e.deltaY > 30) this.next(); else if (e.deltaY < -30) this.prev(); }
    next() { if (this.currentSlide < this.slides.length - 1) this.goTo(this.currentSlide + 1); }
    prev() { if (this.currentSlide > 0) this.goTo(this.currentSlide - 1); }
    goTo(i) {
        if (this.isTransitioning || i === this.currentSlide) return;
        this.isTransitioning = true; this.currentSlide = i;
        this.slides[i].scrollIntoView({ behavior: 'smooth' }); this.slides[i].classList.add('visible');
        this.updateNavDots(); this.updateProgress();
        setTimeout(() => { this.isTransitioning = false; }, 600);
    }
    updateNavDots() { document.querySelectorAll('.nav-dot').forEach((d, i) => d.classList.toggle('active', i === this.currentSlide)); }
    updateProgress() { document.getElementById('progressBar').style.width = ((this.currentSlide + 1) / this.slides.length) * 100 + '%'; }
}

/* ===========================================
   LIQUID ETHER ‚Äî WebGL Fluid Simulation
   Ported from React Bits (reactbits.dev)
   =========================================== */
(function() {
    var container = document.getElementById('liquid-ether-bg');
    if (!container || typeof THREE === 'undefined') return;

    var COLORS = ['#a3b931', '#ff9ee0', '#a3ebf0'];
    var MOUSE_FORCE = 20;
    var CURSOR_SIZE = 40;
    var DT = 0.014;
    var RESOLUTION = 0.5;
    var ITERATIONS_POISSON = 32;
    var ITERATIONS_VISCOUS = 32;
    var IS_VISCOUS = true;
    var VISCOUS = 30;
    var IS_BOUNCE = false;
    var BFECC = true;
    var AUTO_SPEED = 0.5;
    var AUTO_INTENSITY = 2.2;
    var AUTO_RESUME_DELAY = 3000;
    var AUTO_RAMP_DURATION = 0.6;
    var TAKEOVER_DURATION = 0.25;

    // Palette texture
    function makePaletteTexture(stops) {
        var arr = stops.length > 0 ? stops : ['#ffffff', '#ffffff'];
        if (arr.length === 1) arr = [arr[0], arr[0]];
        var w = arr.length;
        var data = new Uint8Array(w * 4);
        for (var i = 0; i < w; i++) {
            var c = new THREE.Color(arr[i]);
            data[i * 4] = Math.round(c.r * 255);
            data[i * 4 + 1] = Math.round(c.g * 255);
            data[i * 4 + 2] = Math.round(c.b * 255);
            data[i * 4 + 3] = 255;
        }
        var tex = new THREE.DataTexture(data, w, 1, THREE.RGBAFormat);
        tex.magFilter = THREE.LinearFilter;
        tex.minFilter = THREE.LinearFilter;
        tex.wrapS = THREE.ClampToEdgeWrapping;
        tex.wrapT = THREE.ClampToEdgeWrapping;
        tex.generateMipmaps = false;
        tex.needsUpdate = true;
        return tex;
    }
    var paletteTex = makePaletteTexture(COLORS);
    var bgC = new THREE.Color('#0c0618');
    var bgVec4 = new THREE.Vector4(bgC.r, bgC.g, bgC.b, 1.0);

    // Shaders
    var face_vert = 'attribute vec3 position; uniform vec2 px; uniform vec2 boundarySpace; varying vec2 uv; precision highp float; void main(){ vec3 pos = position; vec2 scale = 1.0 - boundarySpace * 2.0; pos.xy = pos.xy * scale; uv = vec2(0.5)+(pos.xy)*0.5; gl_Position = vec4(pos, 1.0); }';
    var line_vert = 'attribute vec3 position; uniform vec2 px; precision highp float; varying vec2 uv; void main(){ vec3 pos = position; uv = 0.5 + pos.xy * 0.5; vec2 n = sign(pos.xy); pos.xy = abs(pos.xy) - px * 1.0; pos.xy *= n; gl_Position = vec4(pos, 1.0); }';
    var mouse_vert = 'precision highp float; attribute vec3 position; attribute vec2 uv; uniform vec2 center; uniform vec2 scale; uniform vec2 px; varying vec2 vUv; void main(){ vec2 pos = position.xy * scale * 2.0 * px + center; vUv = uv; gl_Position = vec4(pos, 0.0, 1.0); }';
    var advection_frag = 'precision highp float; uniform sampler2D velocity; uniform float dt; uniform bool isBFECC; uniform vec2 fboSize; uniform vec2 px; varying vec2 uv; void main(){ vec2 ratio = max(fboSize.x, fboSize.y) / fboSize; if(isBFECC == false){ vec2 vel = texture2D(velocity, uv).xy; vec2 uv2 = uv - vel * dt * ratio; vec2 newVel = texture2D(velocity, uv2).xy; gl_FragColor = vec4(newVel, 0.0, 0.0); } else { vec2 spot_new = uv; vec2 vel_old = texture2D(velocity, uv).xy; vec2 spot_old = spot_new - vel_old * dt * ratio; vec2 vel_new1 = texture2D(velocity, spot_old).xy; vec2 spot_new2 = spot_old + vel_new1 * dt * ratio; vec2 error = spot_new2 - spot_new; vec2 spot_new3 = spot_new - error / 2.0; vec2 vel_2 = texture2D(velocity, spot_new3).xy; vec2 spot_old2 = spot_new3 - vel_2 * dt * ratio; vec2 newVel2 = texture2D(velocity, spot_old2).xy; gl_FragColor = vec4(newVel2, 0.0, 0.0); } }';
    var color_frag = 'precision highp float; uniform sampler2D velocity; uniform sampler2D palette; uniform vec4 bgColor; varying vec2 uv; void main(){ vec2 vel = texture2D(velocity, uv).xy; float lenv = clamp(length(vel), 0.0, 1.0); vec3 c = texture2D(palette, vec2(lenv, 0.5)).rgb; vec3 outRGB = mix(bgColor.rgb, c, lenv); float outA = mix(bgColor.a, 1.0, lenv); gl_FragColor = vec4(outRGB, outA); }';
    var divergence_frag = 'precision highp float; uniform sampler2D velocity; uniform float dt; uniform vec2 px; varying vec2 uv; void main(){ float x0 = texture2D(velocity, uv-vec2(px.x, 0.0)).x; float x1 = texture2D(velocity, uv+vec2(px.x, 0.0)).x; float y0 = texture2D(velocity, uv-vec2(0.0, px.y)).y; float y1 = texture2D(velocity, uv+vec2(0.0, px.y)).y; float divergence = (x1 - x0 + y1 - y0) / 2.0; gl_FragColor = vec4(divergence / dt); }';
    var externalForce_frag = 'precision highp float; uniform vec2 force; uniform vec2 center; uniform vec2 scale; uniform vec2 px; varying vec2 vUv; void main(){ vec2 circle = (vUv - 0.5) * 2.0; float d = 1.0 - min(length(circle), 1.0); d *= d; gl_FragColor = vec4(force * d, 0.0, 1.0); }';
    var poisson_frag = 'precision highp float; uniform sampler2D pressure; uniform sampler2D divergence; uniform vec2 px; varying vec2 uv; void main(){ float p0 = texture2D(pressure, uv + vec2(px.x * 2.0, 0.0)).r; float p1 = texture2D(pressure, uv - vec2(px.x * 2.0, 0.0)).r; float p2 = texture2D(pressure, uv + vec2(0.0, px.y * 2.0)).r; float p3 = texture2D(pressure, uv - vec2(0.0, px.y * 2.0)).r; float div = texture2D(divergence, uv).r; float newP = (p0 + p1 + p2 + p3) / 4.0 - div; gl_FragColor = vec4(newP); }';
    var pressure_frag = 'precision highp float; uniform sampler2D pressure; uniform sampler2D velocity; uniform vec2 px; uniform float dt; varying vec2 uv; void main(){ float step = 1.0; float p0 = texture2D(pressure, uv + vec2(px.x * step, 0.0)).r; float p1 = texture2D(pressure, uv - vec2(px.x * step, 0.0)).r; float p2 = texture2D(pressure, uv + vec2(0.0, px.y * step)).r; float p3 = texture2D(pressure, uv - vec2(0.0, px.y * step)).r; vec2 v = texture2D(velocity, uv).xy; vec2 gradP = vec2(p0 - p1, p2 - p3) * 0.5; v = v - gradP * dt; gl_FragColor = vec4(v, 0.0, 1.0); }';
    var viscous_frag = 'precision highp float; uniform sampler2D velocity; uniform sampler2D velocity_new; uniform float v; uniform vec2 px; uniform float dt; varying vec2 uv; void main(){ vec2 old = texture2D(velocity, uv).xy; vec2 new0 = texture2D(velocity_new, uv + vec2(px.x * 2.0, 0.0)).xy; vec2 new1 = texture2D(velocity_new, uv - vec2(px.x * 2.0, 0.0)).xy; vec2 new2 = texture2D(velocity_new, uv + vec2(0.0, px.y * 2.0)).xy; vec2 new3 = texture2D(velocity_new, uv - vec2(0.0, px.y * 2.0)).xy; vec2 newv = 4.0 * old + v * dt * (new0 + new1 + new2 + new3); newv /= 4.0 * (1.0 + v * dt); gl_FragColor = vec4(newv, 0.0, 0.0); }';

    // Common
    var Common = {
        width: 0, height: 0, aspect: 1, pixelRatio: 1, renderer: null, clock: null, time: 0, delta: 0,
        init: function(el) {
            this.container = el;
            this.pixelRatio = Math.min(window.devicePixelRatio || 1, 2);
            this.resize();
            this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            this.renderer.autoClear = false;
            this.renderer.setClearColor(new THREE.Color(0x000000), 0);
            this.renderer.setPixelRatio(this.pixelRatio);
            this.renderer.setSize(this.width, this.height);
            this.renderer.domElement.style.width = '100%';
            this.renderer.domElement.style.height = '100%';
            this.renderer.domElement.style.display = 'block';
            this.clock = new THREE.Clock(); this.clock.start();
        },
        resize: function() {
            if (!this.container) return;
            var rect = this.container.getBoundingClientRect();
            this.width = Math.max(1, Math.floor(rect.width));
            this.height = Math.max(1, Math.floor(rect.height));
            this.aspect = this.width / this.height;
            if (this.renderer) this.renderer.setSize(this.width, this.height, false);
        },
        update: function() { this.delta = this.clock.getDelta(); this.time += this.delta; }
    };

    // Mouse
    var Mouse = {
        mouseMoved: false, coords: new THREE.Vector2(), coords_old: new THREE.Vector2(),
        diff: new THREE.Vector2(), timer: null, container: null, isHoverInside: false,
        hasUserControl: false, isAutoActive: false, autoIntensity: AUTO_INTENSITY,
        takeoverActive: false, takeoverStartTime: 0, takeoverDuration: TAKEOVER_DURATION,
        takeoverFrom: new THREE.Vector2(), takeoverTo: new THREE.Vector2(), onInteract: null,
        init: function(el) {
            this.container = el;
            var self = this;
            window.addEventListener('mousemove', function(e) { self._onMouseMove(e); });
            window.addEventListener('touchstart', function(e) { self._onTouchStart(e); }, { passive: true });
            window.addEventListener('touchmove', function(e) { self._onTouchMove(e); }, { passive: true });
            window.addEventListener('touchend', function() { self.isHoverInside = false; });
            document.addEventListener('mouseleave', function() { self.isHoverInside = false; });
        },
        isPointInside: function(cx, cy) {
            if (!this.container) return false;
            var r = this.container.getBoundingClientRect();
            return cx >= r.left && cx <= r.right && cy >= r.top && cy <= r.bottom;
        },
        setCoords: function(x, y) {
            if (!this.container) return;
            if (this.timer) clearTimeout(this.timer);
            var r = this.container.getBoundingClientRect();
            if (r.width === 0 || r.height === 0) return;
            var nx = (x - r.left) / r.width, ny = (y - r.top) / r.height;
            this.coords.set(nx * 2 - 1, -(ny * 2 - 1));
            this.mouseMoved = true;
            var self = this;
            this.timer = setTimeout(function() { self.mouseMoved = false; }, 100);
        },
        setNormalized: function(nx, ny) { this.coords.set(nx, ny); this.mouseMoved = true; },
        _onMouseMove: function(e) {
            this.isHoverInside = this.isPointInside(e.clientX, e.clientY);
            if (!this.isHoverInside) return;
            if (this.onInteract) this.onInteract();
            if (this.isAutoActive && !this.hasUserControl && !this.takeoverActive) {
                var r = this.container.getBoundingClientRect();
                if (r.width === 0 || r.height === 0) return;
                var nx = (e.clientX - r.left) / r.width, ny = (e.clientY - r.top) / r.height;
                this.takeoverFrom.copy(this.coords);
                this.takeoverTo.set(nx * 2 - 1, -(ny * 2 - 1));
                this.takeoverStartTime = performance.now();
                this.takeoverActive = true;
                this.hasUserControl = true;
                this.isAutoActive = false;
                return;
            }
            this.setCoords(e.clientX, e.clientY);
            this.hasUserControl = true;
        },
        _onTouchStart: function(e) {
            if (e.touches.length !== 1) return;
            var t = e.touches[0];
            this.isHoverInside = this.isPointInside(t.clientX, t.clientY);
            if (!this.isHoverInside) return;
            if (this.onInteract) this.onInteract();
            this.setCoords(t.clientX, t.clientY);
            this.hasUserControl = true;
        },
        _onTouchMove: function(e) {
            if (e.touches.length !== 1) return;
            var t = e.touches[0];
            this.isHoverInside = this.isPointInside(t.clientX, t.clientY);
            if (!this.isHoverInside) return;
            if (this.onInteract) this.onInteract();
            this.setCoords(t.clientX, t.clientY);
        },
        update: function() {
            if (this.takeoverActive) {
                var t = (performance.now() - this.takeoverStartTime) / (this.takeoverDuration * 1000);
                if (t >= 1) {
                    this.takeoverActive = false;
                    this.coords.copy(this.takeoverTo);
                    this.coords_old.copy(this.coords);
                    this.diff.set(0, 0);
                } else {
                    var k = t * t * (3 - 2 * t);
                    this.coords.copy(this.takeoverFrom).lerp(this.takeoverTo, k);
                }
            }
            this.diff.subVectors(this.coords, this.coords_old);
            this.coords_old.copy(this.coords);
            if (this.coords_old.x === 0 && this.coords_old.y === 0) this.diff.set(0, 0);
            if (this.isAutoActive && !this.takeoverActive) this.diff.multiplyScalar(this.autoIntensity);
        }
    };

    // AutoDriver
    var AutoDriver = {
        enabled: true, speed: AUTO_SPEED, resumeDelay: AUTO_RESUME_DELAY,
        rampDurationMs: AUTO_RAMP_DURATION * 1000, active: false,
        current: new THREE.Vector2(0, 0), target: new THREE.Vector2(),
        lastTime: performance.now(), activationTime: 0, margin: 0.2,
        _tmpDir: new THREE.Vector2(), lastUserInteraction: performance.now(),
        pickNewTarget: function() {
            this.target.set((Math.random() * 2 - 1) * (1 - this.margin), (Math.random() * 2 - 1) * (1 - this.margin));
        },
        forceStop: function() { this.active = false; Mouse.isAutoActive = false; },
        update: function() {
            if (!this.enabled) return;
            var now = performance.now();
            if (now - this.lastUserInteraction < this.resumeDelay) { if (this.active) this.forceStop(); return; }
            if (Mouse.isHoverInside) { if (this.active) this.forceStop(); return; }
            if (!this.active) {
                this.active = true; this.current.copy(Mouse.coords);
                this.lastTime = now; this.activationTime = now; this.pickNewTarget();
            }
            Mouse.isAutoActive = true;
            var dtSec = (now - this.lastTime) / 1000; this.lastTime = now;
            if (dtSec > 0.2) dtSec = 0.016;
            var dir = this._tmpDir.subVectors(this.target, this.current);
            var dist = dir.length();
            if (dist < 0.01) { this.pickNewTarget(); return; }
            dir.normalize();
            var ramp = 1;
            if (this.rampDurationMs > 0) { var rt = Math.min(1, (now - this.activationTime) / this.rampDurationMs); ramp = rt * rt * (3 - 2 * rt); }
            var move = Math.min(this.speed * dtSec * ramp, dist);
            this.current.addScaledVector(dir, move);
            Mouse.setNormalized(this.current.x, this.current.y);
        }
    };
    AutoDriver.pickNewTarget();

    // ShaderPass
    function ShaderPass(props) {
        this.props = props || {};
        this.uniforms = this.props.material ? this.props.material.uniforms : null;
        this.scene = null; this.camera = null; this.material = null; this.geometry = null; this.plane = null;
    }
    ShaderPass.prototype.init = function() {
        this.scene = new THREE.Scene(); this.camera = new THREE.Camera();
        if (this.uniforms) {
            this.material = new THREE.RawShaderMaterial(this.props.material);
            this.geometry = new THREE.PlaneGeometry(2.0, 2.0);
            this.plane = new THREE.Mesh(this.geometry, this.material);
            this.scene.add(this.plane);
        }
    };
    ShaderPass.prototype.update = function() {
        Common.renderer.setRenderTarget(this.props.output || null);
        Common.renderer.render(this.scene, this.camera);
        Common.renderer.setRenderTarget(null);
    };

    // FBO options
    function fboOpts(w, h) {
        var isIOS = /(iPad|iPhone|iPod)/i.test(navigator.userAgent);
        return { type: isIOS ? THREE.HalfFloatType : THREE.FloatType, depthBuffer: false, stencilBuffer: false, minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, wrapS: THREE.ClampToEdgeWrapping, wrapT: THREE.ClampToEdgeWrapping };
    }

    // Simulation
    var simFboSize = new THREE.Vector2();
    var simCellScale = new THREE.Vector2();
    var simBoundarySpace = new THREE.Vector2();
    var fbos = {};

    function calcSize() {
        var w = Math.max(1, Math.round(RESOLUTION * Common.width));
        var h = Math.max(1, Math.round(RESOLUTION * Common.height));
        simCellScale.set(1.0 / w, 1.0 / h);
        simFboSize.set(w, h);
    }

    function createFBOs() {
        var o = fboOpts();
        var keys = ['vel_0', 'vel_1', 'vel_viscous0', 'vel_viscous1', 'div', 'pressure_0', 'pressure_1'];
        keys.forEach(function(k) { fbos[k] = new THREE.WebGLRenderTarget(simFboSize.x, simFboSize.y, o); });
    }

    function resizeFBOs() {
        calcSize();
        for (var k in fbos) fbos[k].setSize(simFboSize.x, simFboSize.y);
    }

    calcSize();
    createFBOs();

    // Advection pass
    var advection = new ShaderPass({
        material: { vertexShader: face_vert, fragmentShader: advection_frag,
            uniforms: { boundarySpace: { value: simCellScale }, px: { value: simCellScale }, fboSize: { value: simFboSize }, velocity: { value: fbos.vel_0.texture }, dt: { value: DT }, isBFECC: { value: true } }
        }, output: fbos.vel_1
    });
    advection.init();
    // Boundary lines
    var bVerts = new Float32Array([-1,-1,0,-1,1,0,-1,1,0,1,1,0,1,1,0,1,-1,0,1,-1,0,-1,-1,0]);
    var bGeom = new THREE.BufferGeometry();
    bGeom.setAttribute('position', new THREE.BufferAttribute(bVerts, 3));
    var bMat = new THREE.RawShaderMaterial({ vertexShader: line_vert, fragmentShader: advection_frag, uniforms: advection.uniforms });
    var bLine = new THREE.LineSegments(bGeom, bMat);
    bLine.visible = false;
    advection.scene.add(bLine);

    // External force pass
    var extForce = new ShaderPass({ output: fbos.vel_1 });
    extForce.init();
    var mouseG = new THREE.PlaneGeometry(1, 1);
    var mouseM = new THREE.RawShaderMaterial({
        vertexShader: mouse_vert, fragmentShader: externalForce_frag,
        blending: THREE.AdditiveBlending, depthWrite: false,
        uniforms: { px: { value: simCellScale }, force: { value: new THREE.Vector2(0, 0) }, center: { value: new THREE.Vector2(0, 0) }, scale: { value: new THREE.Vector2(CURSOR_SIZE, CURSOR_SIZE) } }
    });
    var mouseMesh = new THREE.Mesh(mouseG, mouseM);
    extForce.scene.add(mouseMesh);

    // Viscous pass
    var viscousPass = new ShaderPass({
        material: { vertexShader: face_vert, fragmentShader: viscous_frag,
            uniforms: { boundarySpace: { value: simBoundarySpace }, velocity: { value: fbos.vel_1.texture }, velocity_new: { value: fbos.vel_viscous0.texture }, v: { value: VISCOUS }, px: { value: simCellScale }, dt: { value: DT } }
        }, output: fbos.vel_viscous1, output0: fbos.vel_viscous0, output1: fbos.vel_viscous1
    });
    viscousPass.init();

    // Divergence pass
    var divPass = new ShaderPass({
        material: { vertexShader: face_vert, fragmentShader: divergence_frag,
            uniforms: { boundarySpace: { value: simBoundarySpace }, velocity: { value: fbos.vel_viscous0.texture }, px: { value: simCellScale }, dt: { value: DT } }
        }, output: fbos.div
    });
    divPass.init();

    // Poisson pass
    var poissonPass = new ShaderPass({
        material: { vertexShader: face_vert, fragmentShader: poisson_frag,
            uniforms: { boundarySpace: { value: simBoundarySpace }, pressure: { value: fbos.pressure_0.texture }, divergence: { value: fbos.div.texture }, px: { value: simCellScale } }
        }, output: fbos.pressure_1, output0: fbos.pressure_0, output1: fbos.pressure_1
    });
    poissonPass.init();

    // Pressure pass
    var pressurePass = new ShaderPass({
        material: { vertexShader: face_vert, fragmentShader: pressure_frag,
            uniforms: { boundarySpace: { value: simBoundarySpace }, pressure: { value: fbos.pressure_0.texture }, velocity: { value: fbos.vel_viscous0.texture }, px: { value: simCellScale }, dt: { value: DT } }
        }, output: fbos.vel_0
    });
    pressurePass.init();

    // Output scene
    var outScene = new THREE.Scene();
    var outCamera = new THREE.Camera();
    var outMesh = new THREE.Mesh(
        new THREE.PlaneGeometry(2, 2),
        new THREE.RawShaderMaterial({
            vertexShader: face_vert, fragmentShader: color_frag,
            transparent: true, depthWrite: false,
            uniforms: { velocity: { value: fbos.vel_0.texture }, boundarySpace: { value: new THREE.Vector2() }, palette: { value: paletteTex }, bgColor: { value: bgVec4 } }
        })
    );
    outScene.add(outMesh);

    // Init
    Common.init(container);
    Mouse.init(container);
    Mouse.onInteract = function() {
        AutoDriver.lastUserInteraction = performance.now();
        AutoDriver.forceStop();
    };
    container.prepend(Common.renderer.domElement);

    var rafId = null;
    var running = false;

    function simulate() {
        if (IS_BOUNCE) simBoundarySpace.set(0, 0); else simBoundarySpace.copy(simCellScale);
        // Advection
        advection.uniforms.dt.value = DT;
        bLine.visible = IS_BOUNCE;
        advection.uniforms.isBFECC.value = BFECC;
        advection.update();
        // External force
        var fx = (Mouse.diff.x / 2) * MOUSE_FORCE, fy = (Mouse.diff.y / 2) * MOUSE_FORCE;
        var csx = CURSOR_SIZE * simCellScale.x, csy = CURSOR_SIZE * simCellScale.y;
        var cx = Math.min(Math.max(Mouse.coords.x, -1 + csx + simCellScale.x * 2), 1 - csx - simCellScale.x * 2);
        var cy = Math.min(Math.max(Mouse.coords.y, -1 + csy + simCellScale.y * 2), 1 - csy - simCellScale.y * 2);
        mouseM.uniforms.force.value.set(fx, fy);
        mouseM.uniforms.center.value.set(cx, cy);
        mouseM.uniforms.scale.value.set(CURSOR_SIZE, CURSOR_SIZE);
        extForce.update();
        // Viscous
        var vel = fbos.vel_1;
        if (IS_VISCOUS) {
            for (var i = 0; i < ITERATIONS_VISCOUS; i++) {
                var fi = (i % 2 === 0) ? viscousPass.props.output0 : viscousPass.props.output1;
                var fo = (i % 2 === 0) ? viscousPass.props.output1 : viscousPass.props.output0;
                viscousPass.uniforms.velocity_new.value = fi.texture;
                viscousPass.props.output = fo;
                viscousPass.uniforms.v.value = VISCOUS;
                viscousPass.uniforms.dt.value = DT;
                viscousPass.update();
                vel = fo;
            }
        }
        // Divergence
        divPass.uniforms.velocity.value = vel.texture;
        divPass.update();
        // Poisson
        var pressure;
        for (var j = 0; j < ITERATIONS_POISSON; j++) {
            var pi = (j % 2 === 0) ? poissonPass.props.output0 : poissonPass.props.output1;
            var po = (j % 2 === 0) ? poissonPass.props.output1 : poissonPass.props.output0;
            poissonPass.uniforms.pressure.value = pi.texture;
            poissonPass.props.output = po;
            poissonPass.update();
            pressure = po;
        }
        // Pressure
        pressurePass.uniforms.velocity.value = vel.texture;
        pressurePass.uniforms.pressure.value = pressure.texture;
        pressurePass.update();
    }

    function render() {
        Common.renderer.setRenderTarget(null);
        Common.renderer.render(outScene, outCamera);
    }

    function loop() {
        if (!running) return;
        AutoDriver.update();
        Mouse.update();
        Common.update();
        simulate();
        render();
        rafId = requestAnimationFrame(loop);
    }

    function resize() {
        Common.resize();
        resizeFBOs();
    }

    window.addEventListener('resize', resize);
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) { running = false; if (rafId) cancelAnimationFrame(rafId); }
        else { running = true; loop(); }
    });

    running = true;
    loop();
})();

document.addEventListener('DOMContentLoaded', function() { new SlidePresentation(); });
</script>
</body>
</html>
